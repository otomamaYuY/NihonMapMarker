# 日本地図マーカー可視化

Pythonの**Folium**ライブラリを活用し、Excelファイルに記載された座標情報をもとに日本地図上へマーカーおよび補助円を描画します。国土地理院が提供するタイルとGeoJSONによる領域情報を利用し、日本国内に特化した地図描画環境を提供します。

## 概要

- **日本地図の描画**  
  本ツールは、指定された中心座標とズームレベルに基づき、Foliumを利用して日本地図を動的に生成します。
  
- **国土地理院タイルの利用**  
  国土地理院が提供するオンラインタイルを背景として採用し、正確な地理情報を表示します。

- **国外マスク機能**  
  GeoJSONファイルから取得した日本領域を内包する外枠情報により、日本以外の領域をマスクするレイヤーを追加。視認性の高いレイアウトを実現しています。

- **Excelデータからの動的マーカー配置**  
  Excelに記載された『lat』（緯度）・『lon』（経度）および『info』（ツールチップ用テキスト）をもとに、各地点へマーカーを配置。オプションとして、マーカーの色指定および円表示（半径10km、透明度調整）にも対応しています。

## 主な機能

1. **地図生成処理**  
   指定された中心座標およびズームレベルを基にFoliumマップオブジェクトを生成し、パン・ズームの範囲制限（日本周辺）を設定します。

2. **国土地理院タイルの採用**  
   オンラインタイルを利用して地図背景を描画し、正確な地理情報の提供を実現します。

3. **日本領域外マスク機能**  
   GeoJSONファイルから読み込んだ日本領域情報を用い、地球全体を背景としたマスクレイヤーを生成。日本国内のみを強調表示します。

4. **Excelによるマーカー・補助円の描画**  
   Excelファイル内の各行データに対して、マーカーの色や円の表示有無、円の色を柔軟に指定でき、各地点を視覚的に表現します。

## 依存ライブラリ

- **Python 3.x**
- **Folium**: インタラクティブな地図描画のためのライブラリ
- **Pandas**: Excelファイルからのデータ読み込みおよび解析に利用
- **JSON**: GeoJSONファイルのパースに標準ライブラリを使用
- **Pathlib**: ファイルパス操作に利用

必要なライブラリは以下のコマンドによりインストールできます。

```bash
pip install folium pandas
```
## ファイル構成

- **main.py**  
  メインスクリプト。実行時に、同ディレクトリ内のExcelファイル（`points.xlsx`）とGeoJSONファイル（`japan_boundary.geojson`）からデータを読み込み、地図を生成しHTMLファイル（`japan_map.html`）として出力します。

- **points.xlsx**  
  各地点の情報が記載されたExcelファイル。必須カラムは以下の通りです:  
  - `lat`：緯度  
  - `lon`：経度  
  - `info`：マーカーに表示するテキスト（ツールチップ用）  
  任意で以下のカラムを指定可能です:  
  - `color`：マーカー色（デフォルトは`blue`）  
  - `show_circle`：補助円表示のフラグ  
  - `circle_color`：補助円の色（デフォルトは`blue`）

- **japan_boundary.geojson**  
  日本領域の境界データを定義したGeoJSONファイル。

- **japan_map.html**  
  生成されたインタラクティブ地図が保存されるHTMLファイル。

## 使用方法

1. **データファイルの配置**  
   プロジェクトルートに、`points.xlsx`と`japan_boundary.geojson`を配置してください。

2. **スクリプト実行**  
   コマンドラインから以下のコマンドを実行します。  
     
   ```bash
   python main.py
3. **地図の確認**  
   生成されたHTMLファイルをWebブラウザで開くと、各地点に配置されたマーカーおよび補助円が表示された日本地図をご確認いただけます。

## 注意点

- 地図背景として利用しているタイルは国土地理院が提供するオンラインタイルです。そのため、ネットワーク接続が必要となります。オフライン環境での利用を検討される場合は、タイルキャッシュ機能の追加やローカルタイルへの切り替えが必要です。

